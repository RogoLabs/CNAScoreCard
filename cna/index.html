<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE Numbering Authorities - CNA ScoreCard</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="cna-styles.css">
    <link rel="icon" type="image/x-icon" href="../favicon.ico">
</head>
<body>
    <div class="nav-links">
        <a href="../index.html">🏠 Home</a>
        <a href="../scoring.html">📊 EAS Methodology</a>
        <a href="index.html" style="background-color: #ecf0f1;">🏛️ CNAs</a>
        <a href="../cves/index.html">🔍 CVEs</a>
        <a href="../completeness/index.html">📋 Completeness</a>
        <a href="https://rogolabs.net" target="_blank" rel="noopener noreferrer" class="rogolabs-link">🔗 RogoLabs</a>
    </div>

    <main class="container" role="main" aria-label="CVE Numbering Authorities">
        <div class="page-header">
            <h1><span class="cna-part">CNA</span>ScoreCard</h1>
        </div>
        
        <div class="header-section">
            <h2>🏛️ CVE Numbering Authorities (CNAs)</h2>
            <p class="main-description">
                Browse individual CNA (CVE Numbering Authority) pages to see detailed scoring breakdowns, 
                recent CVEs, and performance metrics. CNAs are ranked by their Enhanced Assessment Score (EAS), 
                which evaluates the quality and completeness of their CVE publications across six key dimensions.
            </p>
        </div>

        <div class="stats-overview">
            <div class="stat-card">
                <h3>📊 Average EAS Score</h3>
                <div class="stat-value" id="average-score">Loading...</div>
                <p>Mean score across all active CNAs</p>
            </div>
            <div class="stat-card">
                <h3>🏛️ Active CNAs</h3>
                <div class="stat-value" id="total-cnas">Loading...</div>
                <p>CNAs with published CVEs (6mo)</p>
            </div>
            <div class="stat-card">
                <h3>📄 Total CVEs</h3>
                <div class="stat-value" id="total-cves">Loading...</div>
                <p>CVEs analyzed in last 6 months</p>
            </div>
            <div class="stat-card">
                <h3>🏆 Top Performer</h3>
                <div class="stat-value" id="top-performer">Loading...</div>
                <p>Highest scoring CNA</p>
            </div>
        </div>

        <div class="analysis-controls">
            <div class="search-filter">
                <input type="text" id="cna-search" placeholder="🔍 Search CNAs..." aria-label="Search CNAs">
                <select id="sort-select" aria-label="Sort CNAs">
                    <option value="score">Sort by EAS Score</option>
                    <option value="name">Sort by Name</option>
                    <option value="cves">Sort by CVE Count</option>
                    <option value="rank">Sort by Rank</option>
                </select>
            </div>
        </div>

        <div id="table-view" class="cna-table-container">
            <div class="table-header">
                <h2>CNA EAS Score Rankings</h2>
                <p>CNAs ranked by their Enhanced Assessment Score (EAS). Higher scores indicate better quality and completeness of CVE publications.</p>
            </div>
            
            <div class="table-wrapper">
                <table class="cna-table" id="cna-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>CNA</th>
                            <th>EAS Score</th>
                            <th>CVE Count (6mo)</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody id="cna-table-body">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="loading">Loading CNA data...</div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 CNA ScoreCard. Enhanced Assessment Scores based on <a href="../scoring.html">EAS Methodology</a>.</p>
            <p>Last updated: <span id="last-updated">Loading...</span></p>
        </div>
    </footer>

    <script src="cna-script.js"></script>
</body>
</html>